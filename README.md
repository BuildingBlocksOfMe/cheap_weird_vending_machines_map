# 安い自動販売機・変な自動販売機マップ

日本国内の安い自動販売機や変な自動販売機を地図上に共有するアプリケーションです。

## 技術スタック

- **フロントエンド**: React 19 + TypeScript + Vite
- **スタイリング**: Tailwind CSS v4
- **地図**: Leaflet + OpenStreetMap
- **バックエンド**: Supabase (PostgreSQL + Storage)
- **デプロイ**: Hostinger (静的ホスティング)

## 機能

- 🗺️ インタラクティブな地図表示（OpenStreetMap）
- 📍 自販機情報の投稿（位置、価格、写真、コメント）
- 🔍 地図上で自販機の位置を確認
- 📸 写真付き投稿
- 🆓 ログイン不要で誰でも投稿可能

## セットアップ手順

### 1. 依存関係のインストール
```bash
npm install
```

### 2. Supabase のセットアップ

Supabase プロジェクトを作成し、以下の設定を行ってください。

#### データベース
SQLエディタで以下のSQLを実行してテーブルを作成します。

```sql
create type vm_type as enum ('cheap', 'weird');

create table vending_machines (
  id bigint generated by default as identity primary key,
  lat double precision not null,
  lng double precision not null,
  type vm_type not null,
  price integer,
  description text,
  image_path text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- RLS (Row Level Security) の設定
alter table vending_machines enable row level security;

-- 誰でも閲覧可能
create policy "Public vending machines are viewable by everyone."
  on vending_machines for select
  using ( true );

-- 誰でも投稿可能 (認証なし)
create policy "Anyone can insert a new vending machine."
  on vending_machines for insert
  with check ( true );
```

#### Storage
1. `vm-photos` という名前の新しいパブリックバケットを作成します。
2. ポリシー設定で、`anon` ロールに対して `SELECT` と `INSERT` を許可します。

### 3. 環境変数の設定

#### 3-1. Supabaseの接続情報を取得

1. [Supabaseダッシュボード](https://supabase.com/dashboard)にログインします
2. プロジェクトを選択（または新規作成）します
3. 左メニューの **Settings** (⚙️) をクリック
4. **API** を選択
5. 以下の2つの情報をコピーします：
   - **Project URL** (例: `https://xxxxxxxxxxxxx.supabase.co`)
   - **anon public** キー (長い文字列)

#### 3-2. `.env` ファイルを作成

プロジェクトのルートディレクトリに `.env` という名前のファイルを新規作成し、以下の内容を記入します：

```env
VITE_SUPABASE_URL=ここにProject URLを貼り付け
VITE_SUPABASE_ANON_KEY=ここにanonキーを貼り付け
```

**例：**
```env
VITE_SUPABASE_URL=https://abcdefghijklmnop.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFiY2RlZmdoaWprbG1ub3AiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTYzODk2NzI4MCwiZXhwIjoxOTU0NTQzMjgwfQ.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**重要：** `.env` ファイルはGitにコミットされません（`.gitignore`で除外されています）。これは安全です。

### 4. 開発サーバーの起動
```bash
npm run dev
```

## デプロイ (Hostinger)

1. ビルドを実行します。
```bash
npm run build
```

2. `dist` フォルダの中身（`.htaccess`を含む）を Hostinger の `public_html` フォルダにアップロードします。

## ライセンス

このプロジェクトはオープンソースとして公開されています。
